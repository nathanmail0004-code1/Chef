// Image error handler: replace broken product images with inline SVG placeholder and log the broken URL
document.addEventListener('DOMContentLoaded',()=>{const p='assets/placeholder.svg';document.querySelectorAll('.product img').forEach(i=>{i.addEventListener('error',()=>{console.warn('Image failed to load, replacing with placeholder:',i.src);if(i.src!==p)i.src=p})})});
const $=(s,r=document)=>r.querySelector(s),$$=(s,r=document)=>Array.from(r.querySelectorAll(s));async function loadIncludes(){const t=$$('[data-include]');await Promise.all(t.map(async e=>{const r=e.getAttribute('data-include');try{const n=await fetch(r);if(!n.ok)throw new Error(`Failed to load: ${r}`);e.innerHTML=await n.text()}catch(o){console.error(o)}}))}function initUI(){const t=$('#mobileMenuBtn'),e=$('#mobileMenu');function n(){if(!e||!t)return;const n=!e.classList.contains('hidden');e.classList.toggle('hidden'),t.setAttribute('aria-expanded',String(!n))}t&&t.addEventListener('click',n),$$('#mobileMenu a').forEach(a=>a.addEventListener('click',()=>{e&&e.classList.add('hidden'),t&&t.setAttribute('aria-expanded','false')}));function o(n){if(!n)return;n.classList.remove('hidden'),n.setAttribute('aria-hidden','false');const o=n.querySelector('button, [href], input, select, textarea, [tabindex]');o&&o.focus()}function r(n){if(!n)return;n.classList.add('hidden'),n.setAttribute('aria-hidden','true')}const a=$('#bookingModal'),c=$('#checkoutModal');$$('.book-btn').forEach(b=>b.addEventListener('click',()=>o(a)));const d=$('#heroBookBtn');d&&d.addEventListener('click',()=>o(a));const i=$('#bookNowTop');i&&i.addEventListener('click',()=>o(a));const u=$('#bookNowTopMobile');u&&u.addEventListener('click',()=>o(a));$$('.buy-btn').forEach(b=>b.addEventListener('click',s=>{const p=b.getAttribute('data-product-name')||b.closest('.product')?.querySelector('h3')?.innerText||'Product',m=b.getAttribute('data-product-price')||b.closest('.product')?.querySelector('span')?.innerText?.replace(/[^0-9.]/g,'')||'';const t=$('#checkoutProductTitle'),e=$('#checkoutProductPrice'),n=$('#checkoutProductInput'),o=$('#checkoutAmountInput');t&&(t.textContent=p),e&&(e.textContent=m?`$${m}`:'—'),n&&(n.value=p),o&&(o.value=m),o(c)}));$$('.modal-close').forEach(b=>b.addEventListener('click',s=>{const n=s.target.closest('[role="dialog"]');n&&r(n)}));[a,c].forEach(m=>{if(!m)return;m.addEventListener('click',s=>{s.target===m&&r(m)})}),document.addEventListener('keydown',s=>{'Escape'===s.key&&[a,c].forEach(m=>{m&&!m.classList.contains('hidden')&&r(m)})});const f=(n,o=!0)=>{if(!n)return;n.textContent=o,n.classList.remove('hidden'),n.classList.remove('text-red-500','text-green-600'),n.classList.add(o? 'text-red-500':'text-green-600'),setTimeout(()=>n.classList.add('hidden'),o?6e3:4e3)};const l=$('#bookingForm');l&&l.addEventListener('submit',e=>{e.preventDefault();const t=e.target,n=t.name.value.trim(),o=t.email.value.trim(),r=t.date.value, a=$('#bookingFeedback');if(!n||!o||!r)return f(a,'Please complete required fields.'),void 0;if(!/\\S+@\\S+\.\\S+/.test(o))return f(a,'Enter a valid email address.'),void 0;r&&o&&n&&(r&&(r||!0),alert('Thank you! Your booking request has been submitted (demo).'),t.reset(),setTimeout(()=>{},0))});const h=$('#checkoutForm');h&&h.addEventListener('submit',e=>{e.preventDefault();const t=h.checkoutName.value.trim(),n=h.checkoutEmail.value.trim(),o=$('#checkoutFeedback');if(!t||!n)return f(o,'Please complete required fields.'),void 0;if(!/\S+@\S+\.\S+/.test(n))return f(o,'Enter a valid email address.'),void 0; r(c),alert('Order placed (demo). Thank you!'),h.reset()});const g=$('#newsletterForm');g&&g.addEventListener('submit',e=>{e.preventDefault();const t=$('#newsletterEmail').value.trim();if(!/\S+@\S+\.\S+/.test(t))return alert('Please enter a valid email.'),void 0;alert('Thanks for subscribing! (demo)'),g.reset()});const v=$('#contactForm');v&&v.addEventListener('submit',async e=>{e.preventDefault();const t=$('#contactFeedback');const n=new FormData(v),o=(n.get('name')||'').toString().trim(),r=(n.get('email')||'').toString().trim(),a=(n.get('message')||'').toString().trim(),c=(n.get('_honey')||'').toString().trim();if(c)return f(t,'Submission blocked.'),void 0;if(!o||!r||!a)return f(t,'Please complete required fields.'),void 0;if(!/\S+@\S+\.\S+/.test(r))return f(t,'Enter a valid email address.'),void 0;const d='https://formsubmit.co/ajax/nathanmail0004@gmail.com';try{const e=await fetch(d,{method:'POST',body:n}),s=await e.json();if(e.ok&&s.success){f(t,'Thanks — your message has been sent.',!1),v.reset()}else{const i=s.message||'Submission failed — please try again later.';f(t,i)}}catch(i){console.error('Contact submission error',i),f(t,'Network error — please try again later.')}});document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener('click',function(s){const t=this.getAttribute('href');if(t.length===1)return;const n=document.querySelector(t);if(!n)return; s.preventDefault(),n.scrollIntoView({behavior:'smooth',block:'start'})})})}document.addEventListener('DOMContentLoaded',async()=>{await loadIncludes(),initUI()});